---
  - name: Create nova-api DB for Nova
    mysql_db:
      login_user: root
      login_password: "{{ mysql_root_password }}"
      login_host: 127.0.0.1
      name: nova_api
      state: present
      login_unix_socket: /var/run/mysqld/mysqld.sock

  - name: Create nova DB for Nova
    mysql_db:
      login_user: root
      login_password: "{{ mysql_root_password }}"
      login_host: 127.0.0.1
      name: nova
      state: present
      login_unix_socket: /var/run/mysqld/mysqld.sock

  - name: Create nova_cell0 DB for Nova
    mysql_db:
      login_user: root
      login_password: "{{ mysql_root_password }}"
      login_host: 127.0.0.1
      name: nova_cell0
      state: present
      login_unix_socket: /var/run/mysqld/mysqld.sock

  - name: Grant access to the nova_api DB for the service for nova@0.0.0.0
    mysql_user:
      login_host: 127.0.0.1
      login_user: root
      login_password: "{{ mysql_root_password }}"
      name: nova
      host: "{{ item }}"
      password: "{{ nova_db_pass }}"
      priv: nova_api.*:ALL
      login_unix_socket: /var/run/mysqld/mysqld.sock
    with_items:
      - localhost
      - "%"

  - name: Grant access to the nova DB for the service for nova@0.0.0.0
    mysql_user:
      login_host: 127.0.0.1
      login_user: root
      login_password: "{{ mysql_root_password }}"
      name: nova
      host: "{{ item }}"
      password: "{{ nova_db_pass }}"
      priv: nova.*:ALL
      login_unix_socket: /var/run/mysqld/mysqld.sock
    with_items:
      - localhost
      - "%"

  - name: Grant access to the nova_cell0 DB for the service for nova@0.0.0.0
    mysql_user:
      login_host: 127.0.0.1
      login_user: root
      login_password: "{{ mysql_root_password }}"
      name: nova
      host: "{{ item }}"
      password: "{{ nova_db_pass }}"
      priv: nova_cell0.*:ALL
      login_unix_socket: /var/run/mysqld/mysqld.sock
    with_items:
      - localhost
      - "%"
